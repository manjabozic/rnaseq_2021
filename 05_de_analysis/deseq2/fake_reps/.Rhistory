setwd("E:/Manja/deseq2/fake_reps")
library(tidyverse)
library(DESeq2)
counts_II_6 <- as.matrix(read.csv("E:/Manja/deseq2/fake_reps/counts_II_6.csv", header=TRUE, row.names="ENSEMBL_GeneID"))
counts_III_6 <- as.matrix(read.csv("E:/Manja/deseq2/fake_reps/counts_III_6.csv", header=TRUE, row.names="ENSEMBL_GeneID"))
counts_II_24 <- as.matrix(read.csv("E:/Manja/deseq2/fake_reps/counts_II_24.csv", header=TRUE, row.names="ENSEMBL_GeneID"))
counts_III_24 <- as.matrix(read.csv("E:/Manja/deseq2/fake_reps/counts_III_24.csv", header=TRUE, row.names="ENSEMBL_GeneID"))
cd_II_6 <- read.delim("E:/Manja/deseq2/fake_reps/coldata_II_6.txt", sep = "\t", row.names=1)
cd_II_6$condition <- factor(cd_II_6$condition)
cd_II_24 <- read.delim("E:/Manja/deseq2/fake_reps/coldata_II_24.txt", sep = "\t", row.names=1)
cd_II_24$condition <- factor(cd_II_24$condition)
cd_III_6 <- read.csv("E:/Manja/deseq2/fake_reps/coldata_III_6.txt", sep = "\t", row.names=1)
cd_III_6$condition <- factor(cd_III_6$condition)
cd_III_24 <- read.csv("E:/Manja/deseq2/fake_reps/coldata_III_24.txt", sep = "\t", row.names=1)
cd_III_24$condition <- factor(cd_III_24$condition)
all(rownames(cd_II_24) %in% colnames(counts_II_24))
View(cd_II_24)
View(counts_II_24)
cd_II_24 <- read.delim("E:/Manja/deseq2/fake_reps/coldata_II_24.txt", sep = "\t", row.names=1)
cd_II_24$condition <- factor(cd_II_24$condition)
all(rownames(cd_II_24) %in% colnames(counts_II_24))
all(rownames(cd_III_24) %in% colnames(counts_III_24))
all(rownames(cd_III_6) %in% colnames(counts_III_6))
all(rownames(cd_II_6) %in% colnames(counts_II_6))
all(rownames(cd_II_24) == colnames(counts_II_24))
View(cd_II_24)
View(counts_II_24)
cd_II_24 <- read.delim("E:/Manja/deseq2/fake_reps/coldata_II_24.txt", sep = "\t", row.names=1)
cd_II_24$condition <- factor(cd_II_24$condition)
all(rownames(cd_II_24) %in% colnames(counts_II_24))
all(rownames(cd_II_24) == colnames(counts_II_24))
all(rownames(cd_III_24) == colnames(counts_III_24))
all(rownames(cd_III_6) == colnames(counts_III_6))
all(rownames(cd_II_6) == colnames(counts_II_6))
ddsII6 <- DESeqDataSetFromMatrix(countData = counts_II_6,
colData = cd_II_6,
design = ~ condition)
ddsII24 <- DESeqDataSetFromMatrix(countData = counts_II_24,
colData = cd_II_24,
design = ~ condition)
ddsIII6 <- DESeqDataSetFromMatrix(countData = counts_III_6,
colData = cd_III_6,
design = ~ condition)
ddsIII24 <- DESeqDataSetFromMatrix(countData = counts_III_24,
colData = cd_III_24,
design = ~ condition)
smallestGroupSize <- 1
keep <- rowSums(counts(ddsII6) >= 10) >= smallestGroupSize
ddsII6<- ddsII6l[keep,]
ddsII6<- ddsII6[keep,]
keep <- rowSums(counts(ddsII24) >= 10) >= smallestGroupSize
ddsII24<- ddsII24[keep,]
keep <- rowSums(counts(ddsIII24) >= 10) >= smallestGroupSize
ddsIII24<- ddsIII24[keep,]
keep <- rowSums(counts(ddsIII6) >= 10) >= smallestGroupSize
ddsIII6<- ddsIII6[keep,]

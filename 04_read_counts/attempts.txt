# star comes automatically

#htseq 

htseq-count --stranded=no -s no -r pos -m union -o htseq/cut_c_6_iii.bam -p bam -c htseq/cut_c_6_iii.tsv -n 16 cut_C_6_III.bam ~/rnase
q_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf

htseq-count --stranded=no -s no -r pos -m union -o htseq/cut_t_6_iii.bam -p bam -c htseq/cut_t_6_iii.tsv -n 16 cut_T_6_III.bam ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf

#featurecounts

featureCounts -a ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -G ~/rnaseq_2021/03_mapping/reference_genome/Zm-B73-REFERENCE-NAM-5.0.fa -o rcfc_cut_C_6_III_02.txt -p ~/rnaseq_2021/04_read_counts/cut_C_6_III.bam

#stringtie

#first do it normally

stringtie cut_C_6_III.bam -G ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 16 -o ~/rnaseq_2021/04_read_counts/stringtie/temp_cut_C_6_III.gtf
stringtie cut_T_6_III.bam -G ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 16 -o ~/rnaseq_2021/04_read_counts/stringtie/temp_cut_T_6_III.gtf

#run stringtie merge

stringtie --merge stringtie/temp_cut_C_6_III.gtf stringtie/temp_cut_T_6_III.gtf -G ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 16 -o stringtie/merged_cut_6_III.gtf

#cufflinks
cufflinks -g ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 16 -o ~/rnaseq_2021/04_read_counts/cufflinks --library-type fr-unstranded ~/rnaseq_2021/04_read_counts/cut_C_6_III.bam
cufflinks -g ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 16 -o ~/rnaseq_2021/04_read_counts/cufflinks --library-type fr-unstranded ~/rnaseq_2021/04_read_counts/cut_T_6_III.bam

cuffcompare cut_C_6_III_transcripts.gtf cut_T_6_III_transcripts.gtf -r ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 16


cuffquant -p 16 -u -o ~/rnaseq_2021/04_read_counts/cufflinks/quant ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf --library-type fr-unstranded ~/rnaseq_2021/04_read_counts/cut_T_6_III.bam

cuffnorm -p 16 -o quant/ --library-type fr-unstranded --library-norm-method classic-fpkm ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf ~/rnaseq_2021/04_read_counts/cut_C_6_III.bam ~/rnaseq_2021/04_read_counts/cut_T_6_III.bam

cuffdiff -p 16 -o quant/diff --library-type fr-unstranded --library-norm-method classic-fpkm ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf ~/rnaseq_2021/04_read_counts/cut_C_6_III.bam ~/rnaseq_2021/04_read_counts/cut_T_6_III.bam


stringtie C_6_III.bam -G ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 16 -o ~/rnaseq_2021/04_read_counts/stringtie/temp_cut_C_6_III.gtf

stringtie --merge /scratch/mb62095/star/results/bamfiles/stringtie/temp_C_6_II.gtf /scratch/mb62095/star/results/bamfiles/stringtie/temp_C_6_III.gtf /scratch/mb62095/star/results/bamfiles/stringtie/temp_C_24_II.gtf /scratch/mb62095/star/results/bamfiles/stringtie/temp_C_24_III.gtf /scratch/mb62095/star/results/bamfiles/stringtie/temp_T_6_II.gtf /scratch/mb62095/star/results/bamfiles/stringtie/temp_T_6_III.gtf /scratch/mb62095/star/results/bamfiles/stringtie/temp_T_24_II.gtf /scratch/mb62095/star/results/bamfiles/stringtie/temp_T_24_III.gtf -G ~/rnaseq_2021/03_mapping/reference_genome/Zea_mays_B73_RefGen_v5.exon.gtf -p 32 -o stringtie/merged.gtf
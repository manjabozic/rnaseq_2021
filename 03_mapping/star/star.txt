#GENERATE GENOME INDEXES

STAR --runThreadN 15 --runMode genomeGenerate --genomeDir indexes/ --genomeFastaFiles ~/rnaseq_2021/03_mapping --sjdbGTFfile ~/rnaseq_2021/03_mapping/ --sjdbOverhang 100

#Start a run

#very little difference between the first two

STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMultimapNmax 30 --readFilesIn cut_C_6_III_1P.fq.gz cut_C_6_III_2P.fq.gz

STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMultimapNmax 50 --readFilesIn cut_C_6_III_1P.fq.gz cut_C_6_III_2P.fq.gz

#--alignMatesGapMax does very little

STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMismatchNmax 20 --alignMatesGapMax 2 --outFilterMultimapNmax 50 --readFilesIn cut_C_6_III_1P.fq.gz cut_C_6_III_2P.fq.gz

# --outFilterMismatchNmax significantly reduces the mapping rate

STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMismatchNmax 20 --alignMatesGapMax 1 --outFilterMultimapNmax 50 --readFilesIn cut_C_6_III_1P.fq.gz cut_C_6_III_2P.fq.gz

STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMismatchNmax 10 --outFilterMultimapNmax 50 --readFilesIn cut_C_6_III_1P.fq.gz cut_C_6_III_2P.fq.gz

#not a big difference compared to the first two
STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMismatchNmax 5 --outFilterMultimapNmax 100 --readFilesIn cut_C_6_III_1P.fq.gz cut_C_6_III_2P.fq.gz

STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMismatchNmax 5 --outFilterMultimapNmax 75 --readFilesIn cut_C_6_III_1P.fq.gz cut_C_6_III_2P.fq.gz

#messing around with --otFilterMismatchNmax has a significant effect on the mapping - the higher it is, the higher the mapping rate also

#same with the --outFilterMultimapNmax - to a point

#best option seems to be:

STAR --runThreadN 15 --genomeDir indexes/ --readFilesCommand zcat --quantMode GeneCounts --outFilterMismatchNmax 15 --outFilterMultimapNmax 50 --readFilesIn cut_T_6_III_1P.fq.gz cut_T_6_III_2P.fq.gz
